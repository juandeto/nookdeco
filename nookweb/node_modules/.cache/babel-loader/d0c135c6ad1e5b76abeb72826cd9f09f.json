{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Juan\\\\Desktop\\\\paginanook\\\\nookweb\\\\src\\\\containers\\\\AdminLayout\\\\AdminLayout.js\";\nimport React, { Component } from \"react\";\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\nimport classes from \"./AdminLayout.module.css\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport axios from \"axios\";\nimport DataRespaldo from \"./../../components/Admin/DataRespaldo/DataRespaldo\";\nimport DataCliente from \"./../../components/Admin/DataCliente/DataCliente\";\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\n\nclass AdminLayout extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      orders: [],\n      loading: false\n    };\n\n    this.checkout = () => {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/logout\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 12\n        }\n      });\n    };\n\n    this.orderPagoHandler = id => {\n      let arrayOrders = [...this.state.orders];\n      let index = arrayOrders.findIndex(order => order.id === id);\n      arrayOrders[index].pagado = !this.state.orders[index].pagado;\n      this.setState({\n        orders: arrayOrders\n      });\n    };\n\n    this.formaDeEnvioHandler = id => {\n      let arrayOrders = [...this.state.orders];\n      let index = arrayOrders.findIndex(order => order.id === id);\n      arrayOrders[index].entregado = !this.state.orders[index].entregado;\n      this.setState({\n        orders: arrayOrders\n      });\n    };\n\n    this.deleteOrderHandler = order => {\n      let arrayOrders = [...this.state.orders];\n      arrayOrders = arrayOrders.filter(orden => orden.id !== order.id);\n      console.log(arrayOrders);\n      this.setState({\n        orders: arrayOrders\n      });\n      let url = `https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\n      axios.delete(url, order).then(response => console.log(response)).catch(error => console.log(error));\n    };\n\n    this.saveChanges = order => {\n      let url = `https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\n      axios.put(url, order).then(response => '').catch(error => console.log(error));\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    }); //obtenemos las ordenes\n\n    axios.get(\"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" + this.props.token).then(response => {\n      let data;\n      let arrayOrders = [...this.state.orders];\n\n      for (data in response.data) {\n        let obj = response.data[data];\n        obj.id = data;\n        arrayOrders.push(obj);\n      } //epujamos las ordenes al estado con un id\n\n\n      this.setState({\n        orders: arrayOrders\n      });\n      this.setState({\n        loading: false\n      });\n    }).catch(err => {\n      this.setState({\n        loading: false\n      });\n      console.log(err);\n    });\n  }\n\n  render() {\n    let clasesPago = [classes.nopagado, classes.pagado];\n    let clasesEntregado = [classes.noentregado, classes.entregado];\n    let orders = this.state.orders.map((order, i) => {\n      let pagado = /*#__PURE__*/React.createElement(\"label\", {\n        className: order.pagado ? clasesPago.join(\" \") : clasesPago[0],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }\n      }, order.pagado ? 'PAGADO' : 'NO PAGADO', /*#__PURE__*/React.createElement(\"input\", {\n        onChange: () => this.orderPagoHandler(order.id),\n        type: \"checkbox\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }\n      }));\n      let entregado = /*#__PURE__*/React.createElement(\"label\", {\n        className: order.entregado ? clasesEntregado.join(\" \") : clasesEntregado[0],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 9\n        }\n      }, order.entregado ? \"ENTREGADO\" : \"NO ENTREGADO\", /*#__PURE__*/React.createElement(\"input\", {\n        onChange: () => this.formaDeEnvioHandler(order.id),\n        type: \"checkbox\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }\n      }));\n      return /*#__PURE__*/React.createElement(\"details\", {\n        className: classes.orden,\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"summary\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: classes.nombre,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }\n      }, order.orderData.nombre), /*#__PURE__*/React.createElement(\"span\", {\n        className: classes.date,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }\n      }, order.date), /*#__PURE__*/React.createElement(\"span\", {\n        onClick: () => this.deleteOrderHandler(order),\n        className: classes.btnEliminar,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }\n      }, \"ELIMINAR\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.dataOrden,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }\n      }, \"Precio Final de la orden: $\", order.price), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.pagosContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }\n      }, pagado), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }\n      }, \"Forma de pago: \", order.formaDePago), entregado, /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }\n      }, \"Forma de Envio: \", order.formaDeEnvio), /*#__PURE__*/React.createElement(DataRespaldo, {\n        basket: order.basket,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(DataCliente, {\n        cliente: order.orderData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => this.saveChanges(order),\n        className: classes.saveBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }\n      }, \"Save Changes\"));\n    });\n\n    if (this.state.loading) {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 14\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.AdminLayout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: classes.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }\n    }, \"Admin\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.btns,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }\n    }, this.props.token ? /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.checkout,\n      className: classes.logoutBtn,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }\n    }, \"Logout\") : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.orderContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }\n    }, orders));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));","map":{"version":3,"sources":["C:/Users/Juan/Desktop/paginanook/nookweb/src/containers/AdminLayout/AdminLayout.js"],"names":["React","Component","withErrorHandler","classes","connect","Redirect","axios","DataRespaldo","DataCliente","Spinner","AdminLayout","state","orders","loading","checkout","orderPagoHandler","id","arrayOrders","index","findIndex","order","pagado","setState","formaDeEnvioHandler","entregado","deleteOrderHandler","filter","orden","console","log","url","delete","then","response","catch","error","saveChanges","put","componentDidMount","get","props","token","data","obj","push","err","render","clasesPago","nopagado","clasesEntregado","noentregado","map","i","join","nombre","orderData","date","btnEliminar","dataOrden","formaDePago","price","pagosContainer","formaDeEnvio","basket","saveBtn","title","btns","logoutBtn","orderContainer","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\r\nimport classes from \"./AdminLayout.module.css\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport DataRespaldo from \"./../../components/Admin/DataRespaldo/DataRespaldo\";\r\nimport DataCliente from \"./../../components/Admin/DataCliente/DataCliente\";\r\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\r\n\r\nclass AdminLayout extends Component {\r\n  state = {\r\n    orders: [],\r\n    loading: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({ loading: true });\r\n\r\n    //obtenemos las ordenes\r\n    axios\r\n      .get(\r\n        \"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" +\r\n          this.props.token\r\n      )\r\n      .then((response) => {\r\n        let data;\r\n        let arrayOrders = [...this.state.orders];\r\n        for (data in response.data) {\r\n          let obj = response.data[data];\r\n          obj.id=data\r\n          arrayOrders.push(obj);\r\n        }\r\n\r\n        //epujamos las ordenes al estado con un id\r\n        this.setState({ orders: arrayOrders });\r\n        this.setState({ loading: false });\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ loading: false });\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  checkout=() =>{\r\n    return <Redirect to=\"/logout\"/>\r\n  }\r\n\r\n  orderPagoHandler = (id) => {\r\n    let arrayOrders = [...this.state.orders];\r\n    let index = arrayOrders.findIndex(order => order.id === id);\r\n    arrayOrders[index].pagado = !this.state.orders[index].pagado;\r\n\r\n    this.setState({orders: arrayOrders})\r\n\r\n  }\r\n\r\n  formaDeEnvioHandler = (id) =>{\r\n    let arrayOrders = [...this.state.orders];\r\n    let index = arrayOrders.findIndex(order => order.id === id);\r\n    arrayOrders[index].entregado = !this.state.orders[index].entregado; \r\n    this.setState({orders: arrayOrders})\r\n  }\r\n\r\n  deleteOrderHandler = (order) =>{\r\n    let arrayOrders = [...this.state.orders];\r\n    arrayOrders=arrayOrders.filter(orden => orden.id !== order.id);\r\n    console.log(arrayOrders);\r\n    this.setState({orders: arrayOrders})\r\n\r\n    let url=`https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\r\n    axios.delete(url, order)\r\n    .then(response => console.log(response))\r\n    .catch(error => console.log(error))\r\n  }\r\n\r\n  saveChanges = (order) =>{\r\n    let url=`https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\r\n    axios.put(url, order)\r\n    .then(response => '')\r\n    .catch(error => console.log(error))\r\n  }\r\n\r\n  render() {\r\n    let clasesPago = [classes.nopagado, classes.pagado];\r\n    let clasesEntregado = [classes.noentregado, classes.entregado];\r\n    \r\n    let orders = this.state.orders.map((order, i) => {\r\n      \r\n      let pagado = (\r\n        <label className={order.pagado ? clasesPago.join(\" \") : clasesPago[0]}>\r\n          {order.pagado ? 'PAGADO' :'NO PAGADO'}\r\n          <input onChange={() => this.orderPagoHandler(order.id)} type=\"checkbox\"  />\r\n        </label>\r\n      );\r\n      \r\n      let entregado = (\r\n        <label className={order.entregado ? clasesEntregado.join(\" \") : clasesEntregado[0]}>\r\n          {order.entregado ? \"ENTREGADO\" : \"NO ENTREGADO\"}\r\n          <input onChange={() => this.formaDeEnvioHandler(order.id)} type=\"checkbox\"  />\r\n        </label>\r\n      );\r\n\r\n      return (\r\n        <details className={classes.orden} key={i}>\r\n          <summary>\r\n            <span className={classes.nombre} >{order.orderData.nombre}</span>\r\n            <span className={classes.date}>{order.date}</span>\r\n            <span onClick={()=>this.deleteOrderHandler(order)}className={classes.btnEliminar}>ELIMINAR</span>\r\n          </summary>\r\n          \r\n          <div className={classes.dataOrden}>\r\n          <div className={classes.formaDePago}>Precio Final de la orden: ${order.price}</div>\r\n            <div className={classes.pagosContainer}>{pagado}</div>\r\n            <div className={classes.formaDePago}>Forma de pago: {order.formaDePago}</div> \r\n            {entregado}\r\n            <div className={classes.formaDePago}>Forma de Envio: {order.formaDeEnvio}</div>\r\n            <DataRespaldo basket={order.basket} />\r\n            <DataCliente cliente={order.orderData} />\r\n\r\n          </div>\r\n          <button \r\n        onClick={()=>this.saveChanges(order)}\r\n        className={classes.saveBtn}>Save Changes</button>\r\n        </details>\r\n      );\r\n    });\r\n\r\n    if (this.state.loading) {\r\n      return <Spinner />;\r\n    }\r\n\r\n    return (\r\n      <div className={classes.AdminLayout}>\r\n        <h2 className={classes.title}>Admin</h2>\r\n        <div className={classes.btns}>\r\n        {this.props.token ? (\r\n            <button onClick={this.checkout} className={classes.logoutBtn}>Logout</button>\r\n        ) : null}\r\n        </div>\r\n        <div className={classes.orderContainer}>{orders}</div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    token: state.auth.token,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));\r\n"]},"metadata":{},"sourceType":"module"}