{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Juan\\\\Desktop\\\\paginanook\\\\nookweb\\\\src\\\\containers\\\\AdminLayout\\\\AdminLayout.js\";\nimport React, { Component } from \"react\";\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\nimport classes from \"./AdminLayout.module.css\";\nimport { connect } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport DataRespaldo from \"./../../components/Admin/DataRespaldo/DataRespaldo\";\nimport DataCliente from \"./../../components/Admin/DataCliente/DataCliente\";\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\n\nclass AdminLayout extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      orders: [],\n      loading: false\n    };\n\n    this.changePagoHandler = (date, id, tipo) => {\n      let orders = [...this.state.orders];\n      let index = orders.findIndex(order => order.date === date);\n      orders.map((order, i) => {\n        if (i === index) {\n          order.pagado = !order.pagado;\n        }\n      });\n      this.setState({\n        orders: orders\n      });\n      this.saveChangesHandler(id, tipo);\n    };\n\n    this.changeEntregaHandler = (date, id, tipo) => {\n      let orders = [...this.state.orders];\n      let index = orders.findIndex(order => order.date === date);\n      orders.map((order, i) => {\n        if (i === index) {\n          order.entregado = !order.entregado;\n        }\n      });\n      this.setState({\n        orders: orders\n      });\n      this.saveChangesHandler(id, tipo);\n    };\n\n    this.saveChangesHandler = (id, tipo, value) => {\n      this.setState({\n        loading: true\n      });\n      axios.put(\"https://nookweb-5fb61.firebaseio.com/orders/\" + id + '/' + tipo, value).then(response => {\n        this.setState({\n          loading: false\n        });\n        console.log(response);\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          loading: false\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    });\n    axios.get(\"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" + this.props.token).then(response => {\n      let data;\n      let arrayOrders = [...this.state.orders];\n\n      for (data in response.data) {\n        console.log(data);\n        let obj = response.data[data];\n        obj.id = data;\n        arrayOrders.push(obj);\n      }\n\n      this.setState({\n        orders: arrayOrders\n      });\n      this.setState({\n        loading: false\n      });\n    }).catch(err => {\n      this.setState({\n        loading: false\n      });\n      console.log(err);\n    });\n  }\n\n  render() {\n    console.log(this.state.orders);\n    let clasesPago = [classes.nopagado];\n    let clasesEntregado = [classes.noentregado];\n    let orders = this.state.orders.map((order, i) => {\n      if (order.pagado) {\n        clasesPago.push(classes.pagado);\n      }\n\n      if (order.entregado) {\n        clasesEntregado.push(classes.entregado);\n      }\n\n      let pagado = /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: clasesPago.join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }\n      }, order.pagado ? 'PAGADO' : 'NO PAGADO'), /*#__PURE__*/React.createElement(\"span\", {\n        onClick: date => this.changePagoHandler(order.date, order.id, 'pagado'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }\n      }, order.pagado ? 'cambiar a NO PAGADO' : 'cambiar a PAGADO'));\n      let entregado = /*#__PURE__*/React.createElement(\"label\", {\n        className: clasesEntregado.join(\" \"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 9\n        }\n      }, order.entregado ? \"ENTREGADO\" : \"NO ENTREGADO\", /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        onChange: date => this.changeEntregaHandler(order.date, order.id, 'entregado'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }\n      }));\n      return /*#__PURE__*/React.createElement(\"details\", {\n        className: classes.orden,\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"summary\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: classes.nombre,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }\n      }, order.orderData.nombre), /*#__PURE__*/React.createElement(\"span\", {\n        className: classes.date,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }\n      }, order.date)), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.dataOrden,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }\n      }, \"Precio Final de la orden: $\", order.price), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.pagosContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }\n      }, pagado), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }\n      }, \"Forma de pago: \", order.formaDePago), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.formaDePago,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }\n      }, \"Forma de Envio: \", order.formaDeEnvio), entregado, /*#__PURE__*/React.createElement(DataRespaldo, {\n        basket: order.basket,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(DataCliente, {\n        cliente: order.orderData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: classes.saveBtn,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }\n      }, \"Guardar cambios\")));\n    });\n\n    if (this.state.loading) {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 14\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.AdminLayout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: classes.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }\n    }, \"Admin\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.btns,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }\n    }, this.props.token ? /*#__PURE__*/React.createElement(Link, {\n      to: \"logout\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: classes.logoutBtn,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 13\n      }\n    }, \"Logout\")) : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.orderContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }\n    }, orders));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));","map":{"version":3,"sources":["C:/Users/Juan/Desktop/paginanook/nookweb/src/containers/AdminLayout/AdminLayout.js"],"names":["React","Component","withErrorHandler","classes","connect","Link","axios","DataRespaldo","DataCliente","Spinner","AdminLayout","state","orders","loading","changePagoHandler","date","id","tipo","index","findIndex","order","map","i","pagado","setState","saveChangesHandler","changeEntregaHandler","entregado","value","put","then","response","console","log","catch","err","componentDidMount","get","props","token","data","arrayOrders","obj","push","render","clasesPago","nopagado","clasesEntregado","noentregado","join","orden","nombre","orderData","dataOrden","formaDePago","price","pagosContainer","formaDeEnvio","basket","saveBtn","title","btns","logoutBtn","orderContainer","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\r\nimport classes from \"./AdminLayout.module.css\";\r\nimport { connect } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport DataRespaldo from \"./../../components/Admin/DataRespaldo/DataRespaldo\";\r\nimport DataCliente from \"./../../components/Admin/DataCliente/DataCliente\";\r\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\r\n\r\nclass AdminLayout extends Component {\r\n  state = {\r\n    orders: [],\r\n    loading: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({ loading: true });\r\n    axios\r\n      .get(\r\n        \"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" +\r\n          this.props.token\r\n      )\r\n      .then((response) => {\r\n        let data;\r\n        let arrayOrders = [...this.state.orders];\r\n        for (data in response.data) {\r\n          console.log(data)\r\n          let obj = response.data[data];\r\n          obj.id=data\r\n          arrayOrders.push(obj);\r\n        }\r\n        this.setState({ orders: arrayOrders });\r\n        this.setState({ loading: false });\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ loading: false });\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  changePagoHandler=(date, id, tipo)=>{\r\n    let orders=[...this.state.orders]\r\n    let index=orders.findIndex(order => order.date === date);\r\n\r\n    orders.map((order, i) =>{\r\n      if(i === index){\r\n        order.pagado = !order.pagado\r\n      }\r\n    })\r\n\r\n    this.setState({orders: orders});\r\n    this.saveChangesHandler(id, tipo)\r\n  }\r\n\r\n  changeEntregaHandler=(date, id, tipo)=>{\r\n    let orders=[...this.state.orders];\r\n    \r\n    let index=orders.findIndex(order => order.date === date);\r\n\r\n    orders.map((order, i) =>{\r\n      if(i === index){\r\n        order.entregado = !order.entregado\r\n      }\r\n    });\r\n\r\n    this.setState({orders: orders})\r\n    this.saveChangesHandler(id, tipo)\r\n  }\r\n\r\n  saveChangesHandler = (id, tipo, value) =>{\r\n    this.setState({ loading: true });\r\n\r\n    axios\r\n    .put(\"https://nookweb-5fb61.firebaseio.com/orders/\"+id+'/'+tipo, value)\r\n    .then(\r\n      response => {\r\n        this.setState({ loading: false })\r\n        console.log(response)\r\n      }\r\n    )\r\n    .catch(err=> {\r\n      console.log(err)\r\n      this.setState({ loading: false })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    console.log(this.state.orders)\r\n    let clasesPago = [classes.nopagado];\r\n    let clasesEntregado = [classes.noentregado];\r\n\r\n    let orders = this.state.orders.map((order, i) => {\r\n      if (order.pagado) {\r\n        clasesPago.push(classes.pagado);\r\n      }\r\n      if (order.entregado) {\r\n        clasesEntregado.push(classes.entregado);\r\n      }\r\n      let pagado = (\r\n        <React.Fragment>\r\n          <span className={clasesPago.join(\" \")}>{order.pagado ? 'PAGADO' :'NO PAGADO'}</span>\r\n          <span onClick={(date)=>this.changePagoHandler(order.date, order.id, 'pagado')}>{order.pagado ?'cambiar a NO PAGADO':'cambiar a PAGADO'}</span>\r\n        </React.Fragment>\r\n      );\r\n      \r\n      let entregado = (\r\n        <label className={clasesEntregado.join(\" \")}>\r\n          {order.entregado ? \"ENTREGADO\" : \"NO ENTREGADO\"}\r\n          <input type=\"checkbox\" onChange={(date)=>this.changeEntregaHandler(order.date, order.id, 'entregado')} />\r\n        </label>\r\n      );\r\n\r\n      return (\r\n        <details className={classes.orden} key={i}>\r\n          <summary>\r\n            <span className={classes.nombre} >{order.orderData.nombre}</span>\r\n            <span className={classes.date}>{order.date}</span>\r\n          </summary>\r\n          <div className={classes.dataOrden}>\r\n          <div className={classes.formaDePago}>Precio Final de la orden: ${order.price}</div>\r\n            <div className={classes.pagosContainer}>{pagado}</div>\r\n            <div className={classes.formaDePago}>Forma de pago: {order.formaDePago}</div>\r\n            <div className={classes.formaDePago}>Forma de Envio: {order.formaDeEnvio}</div>\r\n            {entregado}\r\n            <DataRespaldo basket={order.basket} />\r\n            <DataCliente cliente={order.orderData} />\r\n            <button \r\n            \r\n            className={classes.saveBtn}>Guardar cambios</button>\r\n          </div>\r\n        </details>\r\n      );\r\n    });\r\n\r\n    if (this.state.loading) {\r\n      return <Spinner />;\r\n    }\r\n\r\n    return (\r\n      <div className={classes.AdminLayout}>\r\n        <h2 className={classes.title}>Admin</h2>\r\n        <div className={classes.btns}>\r\n        \r\n        {this.props.token ? (\r\n          <Link to=\"logout\">\r\n            <button className={classes.logoutBtn}>Logout</button>\r\n          </Link>\r\n        ) : null}\r\n        </div>\r\n        <div className={classes.orderContainer}>{orders}</div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    token: state.auth.token,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));\r\n"]},"metadata":{},"sourceType":"module"}