{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Juan\\\\Desktop\\\\paginanook\\\\nookweb\\\\src\\\\containers\\\\AdminLayout\\\\AdminLayout.js\";\nimport React, { Component } from \"react\";\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\nimport classes from \"./AdminLayout.module.css\";\nimport { connect } from \"react-redux\";\nimport axios from \"axios\";\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\nimport ItemOrder from './../../components/Admin/ItemOrder/ItemOrder';\n\nclass AdminLayout extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      orders: [],\n      loading: false,\n      payOrders: 0,\n      delieverOrders: 0,\n      completeOrders: 0\n    };\n\n    this.checkout = () => {\n      return this.props.history.push(\"logout\");\n    };\n\n    this.orderPagoHandler = id => {\n      let arrayOrders = [...this.state.orders];\n      let index = arrayOrders.findIndex(order => order.id === id);\n      arrayOrders[index].pagado = !this.state.orders[index].pagado;\n      this.setState({\n        orders: arrayOrders\n      });\n    };\n\n    this.formaDeEnvioHandler = id => {\n      let arrayOrders = [...this.state.orders];\n      let index = arrayOrders.findIndex(order => order.id === id);\n      arrayOrders[index].entregado = !this.state.orders[index].entregado;\n      this.setState({\n        orders: arrayOrders\n      });\n    };\n\n    this.deleteOrderHandler = order => {\n      let arrayOrders = [...this.state.orders];\n      arrayOrders = arrayOrders.filter(orden => orden.id !== order.id);\n      this.setState({\n        orders: arrayOrders\n      });\n      let url = `https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\n      axios.delete(url, order).then(response => response).catch(error => console.log(error));\n    };\n\n    this.saveChanges = order => {\n      let url = `https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\n      axios.put(url, order).then(response => '').catch(error => error);\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    }); //obtenemos las ordenes\n\n    axios.get(\"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" + this.props.token).then(response => {\n      let data;\n      let arrayOrders = [...this.state.orders];\n\n      for (data in response.data) {\n        let obj = response.data[data];\n        obj.id = data;\n        arrayOrders.push(obj);\n      } //epujamos las ordenes al estado con un id\n\n\n      this.setState({\n        orders: arrayOrders\n      });\n      this.setState({\n        loading: false\n      });\n    }).catch(err => {\n      this.setState({\n        loading: false\n      });\n    });\n  }\n\n  render() {\n    let orders = this.state.orders.map((order, i) => {\n      let item = null;\n\n      if (!order.pagado && !order.entregado) {\n        item = /*#__PURE__*/React.createElement(ItemOrder, {\n          key: i,\n          order: order,\n          orderPagoHandler: this.orderPagoHandler,\n          formaDeEnvioHandler: this.formaDeEnvioHandler,\n          deleteOrderHandler: this.deleteOrderHandler,\n          saveChanges: this.saveChanges,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }\n        });\n      }\n\n      return item;\n    });\n    let payOrders = this.state.orders.map((order, i) => {\n      let item = null;\n\n      if (order.pagado && !order.entregado) {\n        let count = 0;\n        count++;\n        this.setState({\n          payOrders: count\n        });\n        item = /*#__PURE__*/React.createElement(ItemOrder, {\n          key: i,\n          order: order,\n          orderPagoHandler: this.orderPagoHandler,\n          formaDeEnvioHandler: this.formaDeEnvioHandler,\n          deleteOrderHandler: this.deleteOrderHandler,\n          saveChanges: this.saveChanges,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 14\n          }\n        });\n      }\n\n      return item;\n    });\n    let deliverOrders = this.state.orders.map((order, i) => {\n      let item = null;\n\n      if (!order.pagado && order.entregado) {\n        let count = 0;\n        count++;\n        this.setState({\n          deliverOrders: count\n        });\n        item = /*#__PURE__*/React.createElement(ItemOrder, {\n          key: i,\n          order: order,\n          orderPagoHandler: this.orderPagoHandler,\n          formaDeEnvioHandler: this.formaDeEnvioHandler,\n          deleteOrderHandler: this.deleteOrderHandler,\n          saveChanges: this.saveChanges,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 12\n          }\n        });\n      }\n\n      return item;\n    });\n    let completeOrders = this.state.orders.map((order, i) => {\n      if (order.pagado && order.entregado) {\n        let count = 0;\n        count++;\n        this.setState({\n          completeOrders: count\n        });\n        let item = /*#__PURE__*/React.createElement(ItemOrder, {\n          key: i,\n          order: order,\n          orderPagoHandler: this.orderPagoHandler,\n          formaDeEnvioHandler: this.formaDeEnvioHandler,\n          deleteOrderHandler: this.deleteOrderHandler,\n          saveChanges: this.saveChanges,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 16\n          }\n        });\n        return item;\n      }\n    });\n\n    if (this.state.loading) {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 14\n        }\n      });\n    }\n\n    console.log(completeOrders);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.AdminLayout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: classes.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }\n    }, \"Admin\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.btns,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }\n    }, this.props.token ? /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.checkout,\n      className: classes.logoutBtn,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }\n    }, \"Logout\") : null), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }\n    }, \"Total Ordenes: \", this.state.orders.length), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.orderContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }\n    }, orders), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }\n    }, \"Ordenes Pagadas (y no entregadas) (\", this.state.payOrders, \")\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.pagadosContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }\n    }, payOrders), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }\n    }, \"Ordenes Entregadas (y no pagadas) (\", this.state.deliverOrders, \")\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.pagadosContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }\n    }, deliverOrders), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }\n    }, \"Ordenes Pagadas y Entregadas (\", this.state.completeOrders, \")\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.completeOrdersContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 10\n      }\n    }, completeOrders));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));","map":{"version":3,"sources":["C:/Users/Juan/Desktop/paginanook/nookweb/src/containers/AdminLayout/AdminLayout.js"],"names":["React","Component","withErrorHandler","classes","connect","axios","Spinner","ItemOrder","AdminLayout","state","orders","loading","payOrders","delieverOrders","completeOrders","checkout","props","history","push","orderPagoHandler","id","arrayOrders","index","findIndex","order","pagado","setState","formaDeEnvioHandler","entregado","deleteOrderHandler","filter","orden","url","delete","then","response","catch","error","console","log","saveChanges","put","componentDidMount","get","token","data","obj","err","render","map","i","item","count","deliverOrders","title","btns","logoutBtn","length","orderContainer","pagadosContainer","completeOrdersContainer","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport withErrorHandler from './../../hoc/withErrorHandler/withErrorHandler';\r\nimport classes from \"./AdminLayout.module.css\";\r\nimport { connect } from \"react-redux\";\r\nimport axios from \"axios\";\r\nimport Spinner from \"./../../components/Ul/Spinner/Spinner\";\r\nimport ItemOrder from './../../components/Admin/ItemOrder/ItemOrder';\r\n\r\nclass AdminLayout extends Component {\r\n  state = {\r\n    orders: [],\r\n    loading: false,\r\n    payOrders: 0,\r\n    delieverOrders: 0,\r\n    completeOrders: 0\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({ loading: true });\r\n\r\n    //obtenemos las ordenes\r\n    axios\r\n      .get(\r\n        \"https://nookweb-5fb61.firebaseio.com/orders.json?auth=\" +\r\n          this.props.token\r\n      )\r\n      .then((response) => {\r\n        let data;\r\n        let arrayOrders = [...this.state.orders];\r\n        for (data in response.data) {\r\n          let obj = response.data[data];\r\n          obj.id=data\r\n          arrayOrders.push(obj);\r\n        }\r\n\r\n        //epujamos las ordenes al estado con un id\r\n        this.setState({ orders: arrayOrders });\r\n        this.setState({ loading: false });\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ loading: false });\r\n      });\r\n  }\r\n\r\n  checkout=() =>{\r\n    return this.props.history.push(\"logout\")\r\n  }\r\n\r\n  orderPagoHandler = (id) => {\r\n    let arrayOrders = [...this.state.orders];\r\n    let index = arrayOrders.findIndex(order => order.id === id);\r\n    arrayOrders[index].pagado = !this.state.orders[index].pagado;\r\n\r\n    this.setState({orders: arrayOrders})\r\n\r\n  }\r\n\r\n  formaDeEnvioHandler = (id) =>{\r\n    let arrayOrders = [...this.state.orders];\r\n    let index = arrayOrders.findIndex(order => order.id === id);\r\n    arrayOrders[index].entregado = !this.state.orders[index].entregado; \r\n    this.setState({orders: arrayOrders})\r\n  }\r\n\r\n  deleteOrderHandler = (order) =>{\r\n    let arrayOrders = [...this.state.orders];\r\n    arrayOrders=arrayOrders.filter(orden => orden.id !== order.id);\r\n\r\n    this.setState({orders: arrayOrders})\r\n\r\n    let url=`https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\r\n    axios.delete(url, order)\r\n    .then(response => response)\r\n    .catch(error => console.log(error))\r\n  }\r\n\r\n  saveChanges = (order) =>{\r\n    let url=`https://nookweb-5fb61.firebaseio.com/orders/${order.id}.json`;\r\n    axios.put(url, order)\r\n    .then(response => '')\r\n    .catch(error => error)\r\n  }\r\n  \r\n\r\n  render() {\r\n    let orders = this.state.orders.map((order, i) => {\r\n      let item=null;\r\n        if(!order.pagado && !order.entregado){\r\n         item=<ItemOrder \r\n          key={i}\r\n          order={order} \r\n          orderPagoHandler={this.orderPagoHandler}\r\n          formaDeEnvioHandler={this.formaDeEnvioHandler}\r\n          deleteOrderHandler={this.deleteOrderHandler}\r\n          saveChanges={this.saveChanges} />\r\n          \r\n        }\r\n        return item;\r\n    });\r\n    let payOrders = this.state.orders.map((order, i) => {\r\n      let item=null\r\n      if(order.pagado && !order.entregado){\r\n        let count=0;\r\n        count++\r\n        this.setState({payOrders: count})\r\n        item=<ItemOrder \r\n        key={i}\r\n        order={order} \r\n        orderPagoHandler={this.orderPagoHandler}\r\n        formaDeEnvioHandler={this.formaDeEnvioHandler}\r\n        deleteOrderHandler={this.deleteOrderHandler}\r\n        saveChanges={this.saveChanges} />\r\n        \r\n      }\r\n      return item\r\n\r\n  });\r\n\r\n  let deliverOrders = this.state.orders.map((order, i) => {\r\n    let item=null\r\n    if(!order.pagado && order.entregado){\r\n      let count=0;\r\n      count++\r\n      this.setState({deliverOrders: count})\r\n      item=<ItemOrder \r\n      key={i}\r\n      order={order} \r\n      orderPagoHandler={this.orderPagoHandler}\r\n      formaDeEnvioHandler={this.formaDeEnvioHandler}\r\n      deleteOrderHandler={this.deleteOrderHandler}\r\n      saveChanges={this.saveChanges} />\r\n      \r\n    }\r\n    return item\r\n\r\n});\r\n\r\n  let completeOrders = this.state.orders.map((order, i) => {\r\n\r\n    if(order.pagado && order.entregado){\r\n      let count=0;\r\n      count++\r\n      this.setState({completeOrders: count})\r\n     let item= <ItemOrder \r\n      key={i}\r\n      order={order} \r\n      orderPagoHandler={this.orderPagoHandler}\r\n      formaDeEnvioHandler={this.formaDeEnvioHandler}\r\n      deleteOrderHandler={this.deleteOrderHandler}\r\n      saveChanges={this.saveChanges} />\r\n      return item\r\n    }\r\n});\r\n\r\n    if (this.state.loading) {\r\n      return <Spinner />;\r\n    }\r\n    console.log(completeOrders);\r\n    return (\r\n      <div className={classes.AdminLayout}>\r\n        <h2 className={classes.title}>Admin</h2>\r\n        <div className={classes.btns}>\r\n        {this.props.token ? (\r\n            <button onClick={this.checkout} className={classes.logoutBtn}>Logout</button>\r\n        ) : null}\r\n        </div>\r\n        <h3>Total Ordenes: {this.state.orders.length}</h3>\r\n        <div className={classes.orderContainer}>{orders}</div>\r\n        <h3>Ordenes Pagadas (y no entregadas) ({this.state.payOrders})</h3>\r\n        <div className={classes.pagadosContainer}>{payOrders}</div> \r\n        <h3>Ordenes Entregadas (y no pagadas) ({this.state.deliverOrders})</h3>\r\n        <div className={classes.pagadosContainer}>{deliverOrders}</div> \r\n        <h3>Ordenes Pagadas y Entregadas ({this.state.completeOrders})</h3>\r\n         <div className={classes.completeOrdersContainer}>{completeOrders}</div> \r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    token: state.auth.token,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(withErrorHandler(AdminLayout, axios));\r\n"]},"metadata":{},"sourceType":"module"}